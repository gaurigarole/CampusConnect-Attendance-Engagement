<?xml version="1.0" encoding="UTF-8"?>
<FlexiPage xmlns="http://soap.sforce.com/2006/04/metadata">
    <flexiPageRegions>
        <!-- Header with Highlights Panel -->
        <itemInstances>
            <componentInstance>
                <componentName>force:highlightsPanel</componentName>
                <componentInstanceProperties>
                    <name>numColumns</name>
                    <value>3</value>
                </componentInstanceProperties>
            </componentInstance>
        </itemInstances>
        <mode>Replace</mode>
        <name>header</name>
        <type>Region</type>
    </flexiPageRegions>
    
    <flexiPageRegions>
        <!-- Low Attendance Alert Banner -->
        <itemInstances>
            <componentInstance>
                <componentName>studentAttendanceAlert</componentName>
            </componentInstance>
        </itemInstances>
        <mode>Replace</mode>
        <name>alertBanner</name>
        <type>Region</type>
        <visibilityRule>
            <criteria>
                <leftValue>{!Record.Attendance_Percentage__c}</leftValue>
                <operator>LESS_THAN</operator>
                <rightValue>75</rightValue>
            </criteria>
        </visibilityRule>
    </flexiPageRegions>

    <flexiPageRegions>
        <!-- Main Content Area -->
        <itemInstances>
            <!-- Personal Info Section -->
            <componentInstance>
                <componentName>force:recordEditForm</componentName>
                <componentInstanceProperties>
                    <name>columns</name>
                    <value>2</value>
                </componentInstanceProperties>
                <componentInstanceProperties>
                    <name>objectApiName</name>
                    <value>Student__c</value>
                </componentInstanceProperties>
                <componentInstanceProperties>
                    <name>fields</name>
                    <value>First_Name__c,Last_Name__c,Email__c,Student_Number__c</value>
                </componentInstanceProperties>
                <componentInstanceProperties>
                    <name>mode</name>
                    <value>readonly</value>
                </componentInstanceProperties>
            </componentInstance>
        </itemInstances>
        
        <itemInstances>
            <!-- Academic Info Section -->
            <componentInstance>
                <componentName>force:recordEditForm</componentName>
                <componentInstanceProperties>
                    <name>columns</name>
                    <value>2</value>
                </componentInstanceProperties>
                <componentInstanceProperties>
                    <name>objectApiName</name>
                    <value>Student__c</value>
                </componentInstanceProperties>
                <componentInstanceProperties>
                    <name>fields</name>
                    <value>Major__c,Year__c,GPA__c,Status__c</value>
                </componentInstanceProperties>
                <componentInstanceProperties>
                    <name>mode</name>
                    <value>readonly</value>
                </componentInstanceProperties>
            </componentInstance>
        </itemInstances>

        <itemInstances>
            <!-- Attendance Progress Ring -->
            <componentInstance>
                <componentName>studentAttendanceGauge</componentName>
            </componentInstance>
        </itemInstances>
        
        <mode>Replace</mode>
        <name>main</name>
        <type>Region</type>
    </flexiPageRegions>

    <flexiPageRegions>
        <!-- Related Lists and Tabs -->
        <itemInstances>
            <componentInstance>
                <componentName>force:relatedListContainer</componentName>
            </componentInstance>
        </itemInstances>
        <mode>Replace</mode>
        <name>relatedTabContent</name>
        <type>Facet</type>
    </flexiPageRegions>

    <flexiPageRegions>
        <!-- Attendance History Tab -->
        <itemInstances>
            <componentInstance>
                <componentName>force:relatedListSingleContainer</componentName>
                <componentInstanceProperties>
                    <name>relatedListApiName</name>
                    <value>Attendance__c</value>
                </componentInstanceProperties>
                <componentInstanceProperties>
                    <name>showActionBar</name>
                    <value>true</value>
                </componentInstanceProperties>
            </componentInstance>
        </itemInstances>
        <mode>Replace</mode>
        <name>attendanceHistory</name>
        <type>Facet</type>
        <visibilityRule>
            <criteria>
                <leftValue>{!$User.Profile.Name}</leftValue>
                <operator>NOT_EQUAL</operator>
                <rightValue>Student</rightValue>
            </criteria>
        </visibilityRule>
    </flexiPageRegions>

    <flexiPageRegions>
        <!-- Enrolled Courses Tab -->
        <itemInstances>
            <componentInstance>
                <componentName>force:relatedListSingleContainer</componentName>
                <componentInstanceProperties>
                    <name>relatedListApiName</name>
                    <value>StudentCourse__c</value>
                </componentInstanceProperties>
                <componentInstanceProperties>
                    <name>showActionBar</name>
                    <value>true</value>
                </componentInstanceProperties>
            </componentInstance>
        </itemInstances>
        <mode>Replace</mode>
        <name>enrolledCourses</name>
        <type>Facet</type>
    </flexiPageRegions>

    <flexiPageRegions>
        <itemInstances>
            <componentInstance>
                <componentName>runtime_sales_activities:activityPanel</componentName>
                <componentInstanceProperties>
                    <name>enableLogCall</name>
                    <value>false</value>
                </componentInstanceProperties>
                <componentInstanceProperties>
                    <name>enableSendEmail</name>
                    <value>true</value>
                </componentInstanceProperties>
            </componentInstance>
        </itemInstances>
        <mode>Replace</mode>
        <name>activityTabContent</name>
        <type>Facet</type>
    </flexiPageRegions>

    <flexiPageRegions>
        <itemInstances>
            <componentInstance>
                <componentName>force:tabset</componentName>
                <componentInstanceProperties>
                    <name>tabs</name>
                    <value>[
                        {"label":"Related","content":"relatedTabContent"},
                        {"label":"Attendance History","content":"attendanceHistory"},
                        {"label":"Enrolled Courses","content":"enrolledCourses"},
                        {"label":"Activity","content":"activityTabContent"}
                    ]</value>
                </componentInstanceProperties>
            </componentInstance>
        </itemInstances>
        <mode>Replace</mode>
        <name>tabs</name>
        <type>Region</type>
    </flexiPageRegions>

    <masterLabel>Enhanced Student Record Page</masterLabel>
    <sobjectType>Student__c</sobjectType>
    <template>
        <name>flexipage:recordHomeSingleColNoHeaderTemplateDesktop</name>
    </template>
    <type>RecordPage</type>
</FlexiPage>
